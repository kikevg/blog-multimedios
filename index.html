<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog multimedios - Espacio de noticias y pequeños tutoriales</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <!-- Google fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Mulish:wght@500;900&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="./css/main.css">
</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-light bg-white py-4">
        <div class="container">
            <a href="./index.html" class="navbar-brand">
                <img src="./img/logo.svg" alt="" width="25">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMenu"
                aria-controls="navbarMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarMenu">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <div class="">
                            <input type="text" id="search" class="form-control bg-light border-0" placeholder="Buscar">
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 col-md-4 col-lg-3">
                    <div class="card border-0 mb-5">
                        <div class="card-body">
                            <img src="./img/logo.svg" alt="" class="">
                            <h4 class="card-title text-primary my-4 fw-bold">Blog multimedios</h4>
                            <p class="card-text text-dark">Enterate de algunas noticias y novedades sobre tecnología.
                                Aprende con ejemplos practicos</p>
                        </div>
                    </div>

                    <div class="mb-5">
                        <ul class="list-group">
                            <li class="list-group-item border-0 px-0 my-2 bg-transparent">
                                <a href="./index.html" class="text-decoration-none">
                                    <i data-feather="home" class="text-info"></i>
                                    &nbsp;
                                    Home
                                </a>
                            </li>
                            <li class="list-group-item border-0 px-0 my-2 bg-transparent">
                                <a href="./index.html" class="text-decoration-none">
                                    <i data-feather="archive" class="text-success"></i>
                                    &nbsp;
                                    Blog
                                </a>
                            </li>
                            <li class="list-group-item border-0 px-0 my-2 bg-transparent">
                                <a href="./podcast.html" class="text-decoration-none">
                                    <i data-feather="mic" class="text-warning"></i>
                                    &nbsp;
                                    Podcast
                                </a>
                            </li>
                            <li class="list-group-item border-0 px-0 my-2 bg-transparent">
                                <a href="./about.html" class="text-decoration-none">
                                    <i data-feather="users" class="text-danger"></i>
                                    &nbsp;
                                    Nosotros
                                </a>
                            </li>
                        </ul>
                    </div>

                    <div class="mb-5">
                        <h4 class="text-dark">Tags</h4>
                        <ul class="list-unstyled" id="tags"></ul>
                    </div>
                </div>
                <div class="col-sm-12 col-md-8 col-lg-6">
                    <h5 class="text-dark fw-bold mb-5">All posts</h5>
                    <div id="news">

                    </div>
                </div>
                <div class="col-sm-12 col-md-12 col-lg-3">
                    <h5 class="text-dark fw-bold mb-5">Latest news</h5>
                    <div id="latestNews"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- JQeury -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <!-- Bootstrap 5 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
        crossorigin="anonymous"></script>
    <!-- Feather icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.28.0/feather.min.js"></script>
    <!-- Custom script -->
    <script src="./js/news.js"></script>
    <script>

        // tags render

        function renderTags() {
            let tagsRender = '';

            tags.forEach(e => {
                tagsRender += `
                <li>
                    <button type="button" class="btn btn-link btn-tag" data-tag="${e.name}">
                        <i data-feather="hash"></i>
                        ${e.name}
                    </button>
                </li>
                `;
            })

            tagsRender += `
            <li>
                <button type="button" class="btn btn-link" id="clear">
                    <i data-feather="x"></i>
                    Clear
                </button>
            </li>
            `;

            document.getElementById('tags').innerHTML = tagsRender;
        }

        renderTags();


        // latest news

        function renderLatestNews() {

            let latestNewsRender = '';
            let newsTags = '';

            if (news.length > 0) {

                for (let i = 0; i < 2; i++) {

                    news[i].tags.forEach(t => {
                        newsTags += `
                        <span class="badge bg-primary">#${t.name}</span>
                        `;
                    });

                    latestNewsRender += `
                    <a href="./single-news.html?nid=${news[i].id}" class="text-decoration-none"> 
                        <div class="card border-0 mb-5">
                            <div class="card-body">
                                <h5 class="text-dark fw-bold">${news[i].title}</h5>
                                <div class="my-3">
                                    ${newsTags}
                                </div>
                                <div class="d-flex justify-content-between">
                                    <span class="text-secondary">
                                        <i data-feather="heart"></i>
                                        ${news[i].likes} Like(s)
                                    </span>
                                    <span class="text-secondary">${news[i].read} lect</span>
                                </div>
                            </div>
                        </div>
                    </a>
                    `;

                    newsTags = '';
                }
            }

            document.getElementById('latestNews').innerHTML = latestNewsRender;

        }

        renderLatestNews();

        // All posts

        let noticias = [...news];

        function renderNews(news) {

            let newsRender = '';

            if (news.length == 0) {

                newsRender = '<h2 class="fw-bold">Not found</h2>'

            } else {


                let tagsNews = '';

                news.forEach(e => {

                    e.tags.forEach(t => {
                        tagsNews += `
                        <span class="badge bg-primary">#${t.name}</span>
                        `;
                    });

                    newsRender += `    
                    <a href="single-news.html?nid=${e.id}" class="text-decoration-none"> 
                        <div class="card border-0 mb-5">
                            <img src="${e.img}" alt="" class="img-fluid rounded-top">
                            <div class="card-body">
                                <div>
                                    <span class="d-block text-secondary">Fecha de publicación: ${e.date}</span>
                                    <span class="d-block text-secondary">Escrito por: ${e.autor}</span>
                                </div>
                                <h2 class="card-title text-dark fw-bold my-4">${e.title}</h2>
                                <div class="my-3">
                                    ${tagsNews}
                                </div>
                                <div class="py-2 d-flex justify-content-between">
                                    <span class="text-secondary">
                                        <i data-feather="heart"></i>
                                        ${e.likes} Likes
                                    </span>
                                    <span class="text-secondary">
                                        ${e.read} lect
                                    </span>
                                </div>
                            </div>
                        </div>
                    </a>
                    `;

                    tagsNews = '';

                });
            }

            document.getElementById('news').innerHTML = newsRender;

        }

        renderNews(noticias);

        document.getElementById('search').addEventListener('keyup', function (e) {

            console.log(this.value);

            let n = noticias.filter(i => i.title.includes(this.value));
            console.log(n);

            renderNews(n);

        })


        document.querySelectorAll('.btn-tag').forEach(button => {

            button.addEventListener('click', function (e) {

                document.querySelectorAll('.btn-tag').forEach(b => b.style.background = 'none');

                let tag = this.getAttribute('data-tag');

                console.log(tag);

                let n = [];
                let isEquals = false;

                noticias.forEach(i => {

                    i.tags.forEach(t => {
                        if (t.name == tag)
                            isEquals = true;
                    })

                    if (isEquals)
                        n.push(i);

                    isEquals = false;

                });

                renderNews(n);

                this.style.backgroundColor = '#ECF4FF'

            })
        })

        document.getElementById('clear').addEventListener('click', function (e) {
            renderNews(noticias);
        })

        feather.replace();

    </script>

</body>

</html>
